<!doctype html>
<html>
<head>
    <title>Real-time Fraud Detection Demo</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 30px; background-color: #f4f7f6; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; }
        input { width: calc(100% - 20px); padding: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 4px; }
        button { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        pre { background-color: #e9ecef; padding: 15px; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; }
        .APPROVE { color: green; font-weight: bold; }
        .HOLD { color: red; font-weight: bold; }
        .STEP-UP { color: orange; font-weight: bold; }
    </style>
</head>
<body>
  <div class="container">
    <h2>Real-time Fraud Detection Demo</h2>
    <form id="txForm">
      <b>Transaction Amount:</b><br>
      <input id="amount" type="number" placeholder="e.g., 500" value="500"><br>
      <button type="button" onclick="send()">Score Transaction</button>
    </form>
    <h3>Result:</h3>
    <pre id="out">Awaiting transaction...</pre>
  </div>

  <script>
    async function send() {
      const amount = document.getElementById('amount').value;
      if (!amount) {
        alert("Please enter an amount.");
        return;
      }

      const tx = { amount: parseFloat(amount) };
      
      const outElem = document.getElementById('out');
      outElem.innerText = "Scoring in progress...";

      try {
        const res = await fetch('/predict', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(tx)
        });
        const data = await res.json();
        
        // Pretty print JSON and colorize decision
        const decisionClass = data.decision.split(' ')[0]; // "HOLD & REVIEW" -> "HOLD"
        outElem.innerHTML = `<span class="${decisionClass}">${data.decision}</span>\n\n` + JSON.stringify(data, null, 2);

      } catch (error) {
        outElem.innerText = "Error communicating with the server. Is it running?";
        console.error("Error:", error);
      }
    }
  </script>
</body>
</html>